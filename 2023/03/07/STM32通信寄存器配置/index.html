<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="1.0-数据通信方式1.1-串行与并行通信方式串行通讯：是指设备之间通过一根数据信号线，地线以及控制信号线，按数据位形式一位一位地传输数据的通讯方式，同一时刻只能传输一位(bit)数据。并行通讯：是指使用 8、16、32 及 64 根或更多的数据线(有多少信号为就需要多少信号位)进行传输的通讯方式，可以同一时刻传输多个数据位的数据。串行与并行通信优缺点：      特性 串行通讯 并行通讯">
<meta property="og:type" content="article">
<meta property="og:title" content="STM32通信">
<meta property="og:url" content="http://example.com/2023/03/07/STM32%E9%80%9A%E4%BF%A1%E5%AF%84%E5%AD%98%E5%99%A8%E9%85%8D%E7%BD%AE/index.html">
<meta property="og:site_name" content="胜哥爱周周">
<meta property="og:description" content="1.0-数据通信方式1.1-串行与并行通信方式串行通讯：是指设备之间通过一根数据信号线，地线以及控制信号线，按数据位形式一位一位地传输数据的通讯方式，同一时刻只能传输一位(bit)数据。并行通讯：是指使用 8、16、32 及 64 根或更多的数据线(有多少信号为就需要多少信号位)进行传输的通讯方式，可以同一时刻传输多个数据位的数据。串行与并行通信优缺点：      特性 串行通讯 并行通讯">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/8f749a56006b600721c020526e1ed06.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0d0f6022025c136a38756cef510ca54.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/66a036b56f2050ca8886b3760970a42.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87c50ab22f4f4ff2a3a226633fe994a.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/1c96c5860ef7a381d3ca997192f93a8.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/dd6ac179bac3559cda734e4148b0ca8.jpg">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0ad892459721eca3b28560aed015365.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/e1a1087ae519f5085017a69248c864c.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/b23e7254e6a5d6870a8d7455ef39495.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/c9a6a3ee43f2bd4ddecc16286e7b25f.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/ebcbfb009a99f7b3d0392312d174505.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/282bfa66a183e2f99135c98c695b07f.png#pic_center=200x">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87aaf1556b153d3efc50005d5166c91.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/1267c7efa31388d249835414cb29f3c.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87687aea4dbeb800a38e60e9601fe3b.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0183b5a335210b63cb7dc0116cff7b4.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/c300729f189b5d33f0dd8ca7582d7d1.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/edd216e3c33c8fad681f6227b639f8f.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/787c50d94baf758fa35dc98a1b8ae7d.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/88bdd5d13618b9c0e27adcc15d0c187.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/8379bdf54d1080c80d00ade995eb240.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/7d7f81325c591c20b1502e120f4f017.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/64a8c90da0936dbc542b396b1d4f788.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/46820f13d43ad2b6e4cec7f7316c181.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0015b89f673e37a23b779fdea1e4ec8.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/cd0254221fd4203c9ca906aaf3fdbf7.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/689c4f10fea67c84e7c72a5fc4f279c.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/e9a214fe93ff1bcfe675f4625fee255.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/3216a009a4a7a6ec11bc9d1110fefa4.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/82c7399fa6576a64a4fbad3d83ff1fa.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/862ae16a75795c1caccea3e91cafd25.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/577a3b93c0ad2e715862fa41cdc7a69.png">
<meta property="og:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/ffa2797aa879fc7d5d48aee97528169.png">
<meta property="article:published_time" content="2023-03-07T06:11:11.000Z">
<meta property="article:modified_time" content="2023-03-19T15:32:06.480Z">
<meta property="article:author" content="胜哥">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/8f749a56006b600721c020526e1ed06.png">

<link rel="canonical" href="http://example.com/2023/03/07/STM32%E9%80%9A%E4%BF%A1%E5%AF%84%E5%AD%98%E5%99%A8%E9%85%8D%E7%BD%AE/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>STM32通信 | 胜哥爱周周</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/rss2.xml" title="胜哥爱周周" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">胜哥爱周周</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">很高兴认识你，请多多指教</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/07/STM32%E9%80%9A%E4%BF%A1%E5%AF%84%E5%AD%98%E5%99%A8%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="胜哥">
      <meta itemprop="description" content="仰望星空，脚踏实地">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="胜哥爱周周">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          STM32通信
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-07 14:11:11" itemprop="dateCreated datePublished" datetime="2023-03-07T14:11:11+08:00">2023-03-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-19 23:32:06" itemprop="dateModified" datetime="2023-03-19T23:32:06+08:00">2023-03-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8D%95%E7%89%87%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">单片机</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>12 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-0-数据通信方式"><a href="#1-0-数据通信方式" class="headerlink" title="1.0-数据通信方式"></a>1.0-数据通信方式</h1><h2 id="1-1-串行与并行通信方式"><a href="#1-1-串行与并行通信方式" class="headerlink" title="1.1-串行与并行通信方式"></a>1.1-串行与并行通信方式</h2><p><strong>串行通讯：</strong><br>是指设备之间通过一根数据信号线，地线以及控制信号线，按数据位形式一位一位地传输数据的通讯方式，同一时刻只能传输一位(bit)数据。<br><strong>并行通讯：</strong><br>是指使用 8、16、32 及 64 根或更多的数据线(有多少信号为就需要多少信号位)进行传输的通讯方式，可以同一时刻传输多个数据位的数据。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/8f749a56006b600721c020526e1ed06.png"  style="zoom: 50%;" /><br><strong>串行与并行通信优缺点：</strong>  </p>
<table>
<thead>
<tr>
<th align="center">特性</th>
<th align="center">串行通讯</th>
<th align="center">并行通讯</th>
</tr>
</thead>
<tbody><tr>
<td align="center">通讯距离</td>
<td align="center">较远</td>
<td align="center">较近</td>
</tr>
<tr>
<td align="center">抗干扰能力</td>
<td align="center">较强</td>
<td align="center">较弱</td>
</tr>
<tr>
<td align="center">传输速率</td>
<td align="center">较慢</td>
<td align="center">较高</td>
</tr>
<tr>
<td align="center">成本</td>
<td align="center">较低</td>
<td align="center">较高</td>
</tr>
</tbody></table>
<p>并行可以同时发送多位数据所以速度比串行的速度要快很多，但并行要的数据线也更多相对成本会更高，而且并行传输对同步要求较高，且随着通讯速率的提高，信号干扰的问题会显著影响通讯性能。</p>
<h2 id="1-2-全双工、半双工及单工通讯"><a href="#1-2-全双工、半双工及单工通讯" class="headerlink" title="1.2-全双工、半双工及单工通讯"></a>1.2-全双工、半双工及单工通讯</h2><p><strong>单工通信：</strong><br>信息只能单方向传输的工作方式，一个固定为发送设备，另一个固定为接收设备，发送端只能发送信息不能接收信息，接收端只能接收信息不能发送信息，只需一根信号线。举例：广播、电视。<br><strong>半双工通信：</strong><br>可以实现双向的通信，但不能在两个方向上同时进行，必须轮流交替进行，其实也可以理解成一种可以切换方向的单工通信，同一时刻必须只能一个方向传输，只需一根数据线。举例：对讲机。<br><strong>全双工通信：</strong><br>在同一时刻，两个设备之间可以同时收发数据，全双工方式无需进行方向的切换，这种方式要求通讯双方均有发送器和接收器，同时，需要2根数据线。举例：电话。  </p>
<h2 id="1-3-同步通信与异步通信"><a href="#1-3-同步通信与异步通信" class="headerlink" title="1.3-同步通信与异步通信"></a>1.3-同步通信与异步通信</h2><p>根据通讯的数据同步方式，又分为同步和异步两种，可以根据通讯过程中是否有使用到时钟信号进行简单的区分。<br><strong>同步通讯：</strong><br>收发设备双方会使用一根信号线表示时钟信号，在时钟信号的驱动下双方进行协调，同步数据，通讯中通常双方会统一规定在时钟信号的上升沿或下降沿对数据线进行采样，对应时钟极性与时钟相位。<br><strong>异步通讯：</strong><br>不需要时钟信号进行数据同步，它们直接在数据信号中穿插一些同步用的信号位，或者把主体数据进行打包，以数据帧（串口：起始位 数据 校验位(可以没有) 停止位）的格式传输数据，某些通讯中还需要双方约定数据的传输速率（波特率），以便更好地同步。<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0d0f6022025c136a38756cef510ca54.png"></p>
<h2 id="1-4-常见串口通信接口："><a href="#1-4-常见串口通信接口：" class="headerlink" title="1.4-常见串口通信接口："></a>1.4-常见串口通信接口：</h2><table>
<thead>
<tr>
<th align="center">通信标准</th>
<th align="center">引脚说明</th>
<th align="center">通信方式</th>
<th align="center">通信方向</th>
</tr>
</thead>
<tbody><tr>
<td align="center">UART(通用异步收发器)</td>
<td align="center">TXD:发送端、RXD:接受端、GND：公共端</td>
<td align="center">异步通信</td>
<td align="center">全双工</td>
</tr>
<tr>
<td align="center">单总线(1-wire)</td>
<td align="center">DQ:发送&#x2F;接受端</td>
<td align="center">异步通信</td>
<td align="center">半双工</td>
</tr>
<tr>
<td align="center">SPI</td>
<td align="center">SCK:同步时钟、MISO:主机输入，从机输出、MOSI:主机输出，从机输入</td>
<td align="center">同步通信</td>
<td align="center">全双工</td>
</tr>
<tr>
<td align="center">I2C</td>
<td align="center">SCL:同步时钟、SDA:数据输入&#x2F;输出端</td>
<td align="center">同步通信</td>
<td align="center">半双工</td>
</tr>
</tbody></table>
<h1 id="2-0-串口通讯协议"><a href="#2-0-串口通讯协议" class="headerlink" title="2.0-串口通讯协议"></a>2.0-串口通讯协议</h1><p><strong>通讯协议：</strong><br>分为物理层和协议层。物理层规定通讯系统中具有机械、电子功能部分的特性，确保原始数据在物理媒体的传输（通俗一点就是硬件部分）。协议层主要规定通讯逻辑，统一收发双方的数据打包、解包标准（软件）。<br><strong>STM32串口简介:</strong><br>USART-通用同步异步收发器(Universal Synchronous Asynchronous Receiver and Transmitter)是一个串行通信设备，可以灵活地与外部设备进行全双工数据交换。有别于 USART 还有一个UART(Universal Asynchronous Receiver and Transmitter)，它是在 USART 基础上裁剪掉了同步通信功能（时钟同步），只有异步通信。简单区分同步和异步就是看通信时需不需要对外提供时钟输出，我们平时用的串口通信基本都是UART。<br><strong>串行通信一般是以帧格式传输数据，即是一帧一帧的传输，每帧包含有起始信号、数据信息、校验信息(由我们自己设置)、停止信号。</strong>  </p>
<h2 id="2-1-物理层"><a href="#2-1-物理层" class="headerlink" title="2.1-物理层"></a>2.1-物理层</h2><h3 id="2-1-1-RS232标准"><a href="#2-1-1-RS232标准" class="headerlink" title="2.1.1-RS232标准"></a>2.1.1-RS232标准</h3><p>很多单片机内部例如我们所用的STM32，以及一些传感器一般都是TTL电平。RS232是一种串行数据传输形式，称其为串行连接，最经典的标志就是9针孔的DB9电缆RS232电压表示逻辑1 ，0的范围大极大的增强了容错率，主要用于工业设备直接通信。</p>
<table>
<thead>
<tr>
<th align="center">通信标准</th>
<th align="center">电平标准</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TTL</td>
<td align="center">逻辑1：2.4V ~ 5V         逻辑0：0 ~ 0.5V</td>
</tr>
<tr>
<td align="center">RS-232</td>
<td align="center">逻辑1:-15V ~ -3V      逻辑0：+3V ~ +15V</td>
</tr>
</tbody></table>
<p>由上表格可知，TLL与RS-232标准逻辑相反，而且电平也大不相同，若单片机与单片机或其他设备TLL设备通信采用RS-232通信（DB9）,肯定先要进行电平的转化TLL-&gt;RS232 RS232-&gt;TTL。<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/66a036b56f2050ca8886b3760970a42.png">两个通讯设备的“DB9 接口”之间通过串口信号线建立起连接，串口信号线中使用“RS-232标准”传输数据信号。由于RS-232电平标准的信号不能直接被控制器直接识别，所以这些信号会经过一个“电平转换芯片”转换成控制器能识别的“TTL 标准”的电平信号，才能实现通讯。电平转换芯片常有：MAX3232、SP3232 <img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87c50ab22f4f4ff2a3a226633fe994a.png"  style="zoom: 45%;" /></p>
<h3 id="2-1-2-USB转串口标准"><a href="#2-1-2-USB转串口标准" class="headerlink" title="2.1.2-USB转串口标准"></a>2.1.2-USB转串口标准</h3><p>USB转串口：主要用于设备(STM32)与电脑通信。电平转换芯片一般有CH340、PL2303、CP2102、FT232。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/1c96c5860ef7a381d3ca997192f93a8.png">使用时要注意安装CH340驱动。<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/dd6ac179bac3559cda734e4148b0ca8.jpg"  style="zoom: 33%;" />USB转串口原理图：<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0ad892459721eca3b28560aed015365.png"></p>
<h3 id="2-1-3-原生的串口到串口标准"><a href="#2-1-3-原生的串口到串口标准" class="headerlink" title="2.1.3-原生的串口到串口标准"></a>2.1.3-原生的串口到串口标准</h3><p>原生的串口通信主要是控制器跟串口的设备或者传感器通信他们但是TLL电平，不需要经过电平转换芯片来转换电平，直接就用TTL电平通信，GPS模块、GSM模块、串口转WIFI模块、HC04蓝牙模块<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/e1a1087ae519f5085017a69248c864c.png"></p>
<h2 id="2-2-协议层"><a href="#2-2-协议层" class="headerlink" title="2.2-协议层"></a>2.2-协议层</h2><p>串口通讯的协议层中，规定了数据包的内容，它由启始位、主体数据、校验位以及停止位组成，通讯双方的数据包格式要约定一致（一样的起始位 数据 校验位 停止位）才能正常收发数据<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/b23e7254e6a5d6870a8d7455ef39495.png"><br><strong>通讯的起始和停止信号：</strong><br>串口通讯的一个数据包从起始信号开始，直到停止信号结束。数据包的起始信号由一个逻辑 0 的数据位表示，而数据包的停止信号可由 0.5、1、1.5 或 2 个逻辑 1 的数据位表示。在USART_CR2中编程停止位的位数。<br>1个停止位：停止位位数的默认值。<br>2个停止位：可用于常规USART模式、单线模式以及调制解调器模式。<br>0.5个停止位：在智能卡模式下接收数据时使用。<br>1.5个停止位：在智能卡模式下发送和接收数据时使用。<br><strong>有效数据：</strong><br>在数据包的起始位之后紧接着的就是要传输的主体数据内容，也称为有效数据，有效数据的长度常被约定为 5、6、7 或 8 位长。<br><strong>数据校验：</strong><br>（1）、偶校验：校验位使得一帧中的7或8个LSB数据以及校验位中’1’的个数为偶数。例如：数据&#x3D;00110101，有4个’1’，如果选择偶校验(在USART_CR1中的PS＝0)，校验位将是’0’，最后数据检验如果数据有偶数个1则数据传输没有出错(但不是绝对的，如果同时两个数据为发送错误(0变成1)则还是偶数个。<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/c9a6a3ee43f2bd4ddecc16286e7b25f.png"  style="zoom: 33%;" />（2）、奇校验：此校验位使得一帧中的7或8个LSB数据以及校验位中’1’的个数为奇数。例如：数据&#x3D;00110101，有4个’1’，如果选择奇校验(在USART_CR1中的PS＝1)，校验位将是’1’，最后数据检验如果数据有奇数个1则数据传输没有出错，但同样不是绝对的(同时两个1变成0)。  </p>
<h2 id="2-3-USART-功能框图"><a href="#2-3-USART-功能框图" class="headerlink" title="2.3-USART 功能框图"></a>2.3-USART 功能框图</h2><p><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/ebcbfb009a99f7b3d0392312d174505.png"  style="zoom: 75%;" />现在对USART的功能框图的各个部分进行分析。</p>
<h3 id="2-3-1-功能引脚"><a href="#2-3-1-功能引脚" class="headerlink" title="2.3.1-功能引脚"></a>2.3.1-功能引脚</h3><p><strong>TX：</strong>发送数据输出引脚。<br><strong>RX：</strong>接收数据输入引脚。<br><strong>SCLK：</strong>发送器时钟输出引脚。这个引脚仅适用于同步模式。<br><strong>SW_RX：</strong>数据接收引脚，只用于单线和智能卡模式，属于内部引脚，没有具体外部引脚。<br><strong>nRTS：</strong>请求以发送(Request To Send)， n 表示低电平有效。如果使能 RTS 流控制，当<br>USART 接收器准备好接收新数据时就会将 nRTS 变成低电平；当接收寄存器已满时， nRTS<br>将被设置为高电平。该引脚只适用于硬件流控制。<br><strong>nCTS：</strong>清除以发送(Clear To Send)， n表示低电平有效。如果使能 CTS 流控制，发送器<br>在发送下一帧数据之前会检测 nCTS 引脚，如果为低电平，表示可以发送数据，如果为高<br>电平则在发送完当前数据帧之后停止发送。该引脚只适用于硬件流控制。<br><strong>SW_RX、nRTS、nCTS不常用</strong><br>以下引脚都是默认功能引脚，而不是复用功能引脚：  </p>
<table>
    <tr> <!-- 第一行数据 -->
        <th style="text-align:center" colspan="6"> STM32F103VET6 芯片的 USART 引脚 </th> <!-- 表头，用于居中显示；合并 9 行为 CBW 数据封包 -->
    </tr>
    <tr> <!-- 第二行数据 -->
        <th style="text-align:center" rowspan="2"> 引脚 </th> <!-- 表头，用于居中显示；合并 2 行为 字节 -->
        <th style="text-align:center"  colspan="1"> APB1总线 </th>  <!-- 表头，用于居中显示；合并 1 列 -->
        <th style="text-align:center"  colspan="4"> APB1总线 </th>  <!-- 表头，用于居中显示；合并 8 列 -->
    </tr>
    <tr> <!-- 第三行数据 -->
    <td> USART1 </td>
    <td> USART2 </td>
    <td> USART3 </td>
    <td> USART4 </td>
    <td> USART5</td>
    </tr>
    </tr>
    <td> TX </td>
    <td> PA9 </td>
    <td> PA2 </td>
    <td> PB10 </td>
    <td> PC10 </td>
    <td> PC12 </td>
    </tr>
    </tr>
    <td> RX </td>
    <td> PA10</td>
    <td> PA3 </td>
    <td> PB11</td>
    <td> PC11 </td>
    <td> PD2 </td>
    </tr>
    </tr>
    <td> SCLK </td>
    <td> PA8 </td>
    <td> PA4 </td>
    <td> PB12 </td>
    <td>  </td>
    <td>  </td>
    </tr>
    </tr>
    <td> nCTS </td>
    <td> PA11 </td>
    <td> PA0 </td>
    <td> PB13 </td>
    <td>  </td>
    <td>  </td>
    </tr>
    </tr>
    <td> nRTS </td>
    <td> PA12 </td>
    <td> PA1 </td>
    <td> PB14 </td>
    <td>  </td>
    <td>  </td>
    </tr>
</table>

<p>功能所对应的引脚是查阅STM32f10x数据手册得知的，表格如下所示。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/282bfa66a183e2f99135c98c695b07f.png#pic_center=200x">表格中还出现了复用功能，如图所示<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87aaf1556b153d3efc50005d5166c91.png">，这是为了在大型项目中能灵活使用引脚。若使用复用功能则必须配置AFIO，详细可查阅数据手册。</p>
<h3 id="2-3-2-读写单元"><a href="#2-3-2-读写单元" class="headerlink" title="2.3.2-读写单元"></a>2.3.2-读写单元</h3><p><strong>数据寄存器-USART_DR:</strong><br>9位有效，包含一个发送数据寄存器TDR和一个接受数据寄存器RDR。<font color="#dd0000">一个地址对应了两个物理内存</font><br /><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/1267c7efa31388d249835414cb29f3c.png">TDR和RDR都是介于系统总线和移位寄存器之间。发送时把TDR内容并行发送到移位寄存器，然后把移位寄存器数据每一位发送出去。接收时把接收到的每一位顺序保存在接收移位寄存器内然后才并行转移到RDR.<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/87687aea4dbeb800a38e60e9601fe3b.png">在stm32f10x_usart.c文件中有发送数据以及接收数据的相关函数。</p>
<pre><code>void USART_SendData(USART_TypeDef* USARTx, uint16_t Data)
&#123;
  /* Check the parameters */
  assert_param(IS_USART_ALL_PERIPH(USARTx));
  assert_param(IS_USART_DATA(Data)); 
    
  /* Transmit Data */
  USARTx-&gt;DR = (Data &amp; (uint16_t)0x01FF);//发送数据就是CPU通过总线往DR寄存器写入数据
&#125;

uint16_t USART_ReceiveData(USART_TypeDef* USARTx)
&#123;
  /* Check the parameters */
  assert_param(IS_USART_ALL_PERIPH(USARTx));
  
  /* Receive Data */
  return (uint16_t)(USARTx-&gt;DR &amp; (uint16_t)0x01FF);//接收数据就是CPU通过总线往DR寄存器读出数据
&#125;
</code></pre>
<p><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0183b5a335210b63cb7dc0116cff7b4.png"></p>
<h3 id="2-3-3-控制单元"><a href="#2-3-3-控制单元" class="headerlink" title="2.3.3-控制单元"></a>2.3.3-控制单元</h3><h4 id="2-3-3-1-发送器"><a href="#2-3-3-1-发送器" class="headerlink" title="2.3.3.1-发送器"></a>2.3.3.1-发送器</h4><p>发送器根据M位的状态发送8位或9位的数据字。当发送使能位(TE)被设置时，发送移位寄存器中的数据在TX脚上输出，相应的时钟脉冲在CK脚上输出。一个字符帧发送需要三个部分：起始位+数据帧（可能有校验位）+停止位。每个字符(一个数据帧)之前都有一个低电平的起始位，之后跟着的停止位，其数目可配置,数据帧就是我们要发送的 8 位或 9 位数据，数据是从最低位开始传输的,停止位是一定时间周期的高电平。<br><strong>发送过程配置步骤（void USART_Config(void)函数配置）</strong><br><strong>1、激活USART</strong><br>通过在USART_CR1寄存器上置位UE位来激活USART，在stm32f10x_usart.c文件中调用该寄存器的配置函数：void USART_Cmd(USART_TypeDef* USARTx, FunctionalState NewState)。</p>
<pre><code>void USART_Cmd(USART_TypeDef* USARTx, FunctionalState NewState)
&#123;
  /* Check the parameters */
  assert_param(IS_USART_ALL_PERIPH(USARTx));
  assert_param(IS_FUNCTIONAL_STATE(NewState));
  
  if (NewState != DISABLE)
  &#123;
    /* Enable the selected USART by setting the UE bit in the CR1 register */
    USARTx-&gt;CR1 |= CR1_UE_Set;
  &#125;
  else
  &#123;
    /* Disable the selected USART by clearing the UE bit in the CR1 register */
    USARTx-&gt;CR1 &amp;= CR1_UE_Reset;
  &#125;
&#125;
</code></pre>
<p><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/c300729f189b5d33f0dd8ca7582d7d1.png"><br><strong>2、定义数据字长</strong><br>编程USART_CR1的M位来定义字长。在stm32f10x_usart.h文件中定义了关于USART的结构体USART_InitTypeDef，给该结构体的成员USART_WordLength赋相应的值即可。 <img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/edd216e3c33c8fad681f6227b639f8f.png"><br><strong>3、确定停止位数</strong><br>在USART_CR2中编程停止位的位数。在stm32f10x_usart.h文件中定义了关于USART的结构体USART_InitTypeDef，给该结构体的成员USART_StopBits赋相应的值即可。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/787c50d94baf758fa35dc98a1b8ae7d.png"><br><strong>4、使能DMA</strong><br>如果采用多缓冲器通信，配置USART_CR3中的DMA使能位(DMAT)。按多缓冲器通信中的描述配置DMA寄存器,关于DMA下期再详细讲解。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/88bdd5d13618b9c0e27adcc15d0c187.png"><br><strong>5、确定波特率</strong><br>利用USART_BRR寄存器选择要求的波特率。在stm32f10x_usart.h文件中定义了关于USART的结构体USART_InitTypeDef，给该结构体的成员USART_BaudRate赋相应的值即可。例如</p>
<pre><code>#define  DEBUG_USART_BAUDRATE           115200
USART_InitStructure.USART_BaudRate = DEBUG_USART_BAUDRATE;    
</code></pre>
<p>波特率指数据信号对载波的调制速率， 它用单位时间内载波调制状态改变次数来表示，单位为波特。比特率指单位时间内传输的比特数，单位 bit&#x2F;s(bps)。对于USART波特率与比特率相等，以后不区分这两个概念。波特率越大，传输速率越快。USART 的发送器和接收器使用相同的波特率。计算公式如下：<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/8379bdf54d1080c80d00ade995eb240.png"  style="zoom: 33%;" />其中， fPLCK 为 USART 时钟， USARTDIV 是一个存放在波特率寄存器(USART_BRR)的 一 个 无符号定点数。其中DIV_Mantissa[11:0]位定义USARTDIV的整数部分，DIV_Fraction[3:0]位定义 USARTDIV 的小数部分。<br>例如： DIV_Mantissa&#x3D;24(0x18)，DIV_Fraction&#x3D;10(0x0A)，此时USART_BRR值为0x18A；那么USARTDIV的小数位10&#x2F;16&#x3D;0.625；整数位24，最终USARTDIV的值为24.625。<br>如果知道 USARTDIV 值为 27.68，那么 DIV_Fraction&#x3D;16*0.68&#x3D;10.88，最接近的正整数为 11，所以 DIV_Fraction[3:0]为 0xB； DIV_Mantissa&#x3D;整数(27.68)&#x3D;27，即为 0x1B。波特率的常用值有 2400、 9600、 19200、 115200。下面以实例讲解如何设定寄存器值得到波特率的值。<br>我们知道 USART1 使用 APB2 总线时钟，最高可达 72MHz，其他 USART 的最高频率为 36MHz。我们选取USART1作为实例讲解，即fPLCK&#x3D;72MHz。为得到 115200bps 的波特率，此时：115200 &#x3D;7200000016 ✖ USARTDIV解得USARTDIV&#x3D;39.0625，可算得DIV_Fraction&#x3D;0.0625✖16&#x3D;1&#x3D;0x01 ，DIV_Mantissa&#x3D;39&#x3D;0x17，即应该设置USART_BRR的值为0x171。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/7d7f81325c591c20b1502e120f4f017.png" style="zoom: 75%;"/><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/64a8c90da0936dbc542b396b1d4f788.png" style="zoom: 75%;"/><br><strong>6、确定USART模式</strong><br>设置USART_CR1中的TE位，发送一个空闲帧帧(一个数据帧长度的高电平)作为第一次数据发送。这两位在USART_InitTypeDef成员中的USART_Mode中设置，USART模式选择有 USART_Mode_Rx和 USART_Mode_Tx，允许使用逻辑或运算选择两个，它设定USART_CR1寄存器的RE位和TE位。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/46820f13d43ad2b6e4cec7f7316c181.png"></p>
<pre><code>// 配置工作模式，收发一起
USART_InitStructure.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;
</code></pre>
<p>在文件stm32f10x_usart.h中定义了这两个宏  </p>
<pre><code>#define USART_Mode_Rx                ((uint16_t)0x0004)
#define USART_Mode_Tx                ((uint16_t)0x0008)
</code></pre>
<p><strong>7、配置校验位</strong><br>STM32F103 系列控制器USART支持奇偶校验。当使用校验位时，串口传输的长度将是8位的数据帧加上1位的校验位总共9位，此时USART_CR1寄存器的M位需要设置为1，即9数据位。将USART_CR1寄存器的PCE位置1就可以启动奇偶校验控制，奇偶校验由硬件自动完成。启动了奇偶校验控制之后，在发送数据帧时会自动添加校验位，接收数据时自动验证校验位。接收数据时如果出现奇偶校验位验证失败，会见USART_SR寄存器的PE位置1，并可以产生奇偶校验中断。使能了奇偶校验控制后，每个字符帧的格式将变成：起始位+数据帧+校验位+停止位。<br>USART_CR1寄存器的PCE (Parity control enable)位，检验控制使能即选择或者不选择校验。<br>USART_CR1寄存器的PS (Parity selection)位，校验选择，在使能的基础上选择奇校验或偶校验。<br>USART_SR寄存器的PE(Parity error)位，判断是否校验错误，产生中断。  <img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/0015b89f673e37a23b779fdea1e4ec8.png"/><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/cd0254221fd4203c9ca906aaf3fdbf7.png"/><br><strong>8、硬件流控制选择</strong><br>这里讲到的 “流”，指的是数据流；在数据通信中，流控制是管理两个节点之间数据传输速率的过程，以防止出现接收端的数据缓冲区已满，而发送端依然继续发送数据，所导致数据丢失。当接收端的数据缓冲区已满，无法处理数据来时，就发出 “不再接收” 的信号，发送端则停止发送，直到发送端收到 “可以继续发送” 的信号再发送数据。计算机中常用的两种流控制分别是硬件流控制（RTS &#x2F;CTS、DTR &#x2F;DSR等）和软件流控制（XON &#x2F;XOFF）。<br><strong>9、判断数据是否全部转移到移位寄存器</strong><br>把要发送的数据写进USART_DR寄存器(此动作清除TXE位)。在只有一个缓冲器的情况下，对每个待发送的数据重复步骤7。注意连续发送多个数据的时候要判断上一帧数据是否全部从TDR寄存器中转移到移位寄存器里，所使用的寄存器是状态寄存器(USART_SR)中的位7(TXE发送数据寄存器空)<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/689c4f10fea67c84e7c72a5fc4f279c.png" style="zoom: 75%;"/>需要调用stm32f10x_usart.c文件中的函数。</p>
<pre><code>FlagStatus USART_GetFlagStatus(USART_TypeDef* USARTx, uint16_t USART_FLAG)
&#123;
  FlagStatus bitstatus = RESET;
  /* Check the parameters */
  assert_param(IS_USART_ALL_PERIPH(USARTx));
  assert_param(IS_USART_FLAG(USART_FLAG));
  /* The CTS flag is not available for UART4 and UART5 */
  if (USART_FLAG == USART_FLAG_CTS)
  &#123;
    assert_param(IS_USART_123_PERIPH(USARTx));
  &#125;  
  
  if ((USARTx-&gt;SR &amp; USART_FLAG) != (uint16_t)RESET)
  &#123;
    bitstatus = SET;
  &#125;
  else
  &#123;
    bitstatus = RESET;
  &#125;
  return bitstatus;
&#125;
</code></pre>
<p>调用该函数的语句如下：</p>
<pre><code>while (USART_GetFlagStatus(pUSARTx, USART_FLAG_TC)== RESET);
</code></pre>
<p><strong>10、判断移位寄存器是否将数据全部发送出去</strong><br>在USART_DR寄存器中写入最后一个数据字后，要等待状态寄存器(USART_SR)中的位TC&#x3D;1，它表示最后一个数据帧的传输结束(移位寄存器中的数据全部发送完毕)。当需要关闭USART或需要进入停机模式之前，需要确认传输结束，避免破坏最后一次传输。<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/e9a214fe93ff1bcfe675f4625fee255.png"/>同第七步一样也是调用FlagStatus USART_GetFlagStatus(USART_TypeDef* USARTx, uint16_t USART_FLAG)函数来判断TC位是否等于1（即数据是否全部从发送移位寄存器中串行发送出去）。调用函数语句如下：</p>
<pre><code>while(USART_GetFlagStatus(pUSARTx,USART_FLAG_TC)==RESET);
</code></pre>
<p><font color="#dd0000"><strong>11、对于TXE位与TC位的一些自己的理解：</strong></font><br /><br>1、清零TXE位总是通过对数据寄存器的写操作(CPU或DMA)来完成的，当TXE位已经被硬件置1它表明：<br>● 数据已经从TDR移送到移位寄存器，数据发送已经开始(发送移位寄存器正在一位一位向外传输数据)。<br>● TDR寄存器被清空。<br>● 下一个数据可以被写进USART_DR寄存器而不会覆盖先前的数据如果TXEIE位被设置，此标志将产生一个中断。<br>如果此时USART正在发送数据(发送移位寄存器正在一位一位向外传输数据)，对USART_DR寄存器的写操作把数据存进TDR寄存器，并在当前传输结束时把该数据复制进移位寄存器，也就是说移位寄存器里面的数据并不会被覆盖，所以我觉得只要你发送一帧数据等待TXE置1，就算是发送多帧数据时最后也不用等待TC&#x3D;1。<font color="#dd0000">也就是往USART_DR寄存器中写数据只有可能覆盖USART_DR原有的数据（TXE位没有为1就开始写），而不会影响到发送移位寄存器向外发射数据</font><br /></p>
<p>2、如果此时USART没有在发送数据，处于空闲状态，对USART_DR寄存器的写操作直接把数据放进移位寄存器，数据传输开始，TXE位立即被置起。</p>
<p>3、当一帧发送完成时(停止位发送后)并且设置了TXE位，TC位被置起(TC位为1)，如果USART_CR1寄存器中的TCIE位被置起时(TCIE位为1)，则会产生中断。</p>
<p>4、使用下列软件过程清除TC位：<br>&lt;1&gt;．读一次USART_SR寄存器；<br>&lt;2&gt;．写一次USART_DR寄存器。<br>TC位也可以通过软件对它写’0’来清除。此清零方式只推荐在多缓冲器通信模式下使用。<br><font color="#dd0000"><strong>12、对于整个发送过程中所使用到的寄存器、中断的一些理解：</strong></font><br /><br>1、void USART_Config(void)函数配置<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/3216a009a4a7a6ec11bc9d1110fefa4.png"/><br>2、发送数据<img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/82c7399fa6576a64a4fbad3d83ff1fa.png"/></p>
<h4 id="2-3-3-2-接收器"><a href="#2-3-3-2-接收器" class="headerlink" title="2.3.3.2-接收器"></a>2.3.3.2-接收器</h4><p>如果将USART_CR1寄存器的RE位置1，使能USART接收，使得接收器在RX线开始搜索起始位。在确定到起始位后就根据RX线电平状态把数据存放在接收移位寄存器内。接收完成后就把接收移位寄存器数据移到RDR内，并把USART_SR寄存器的RXNE位置1，同时如果USART_CR2寄存器的RXNEIE置1的话可以产生中断。<br><strong>注意：USART的所有中断共用一个中断服务函数DEBUG_USART_IRQHandler();所以在该中断函数中要有对中断标志位进行相应的判断，从而得知对应的中断类型。</strong>  </p>
<p><strong>字符接收：</strong><br>● RXNE位被置1。它表明移位寄存器的内容被转移到RDR。换句话说，数据已经被接收并且可以被读出。<br>● 如果RXNEIE位被设置，产生中断。<br>● 在多缓冲器通信时，RXNE在每个字节接收后被置起，并由DMA对数据寄存器的读操作而清零。<br>● 在单缓冲器模式里，由软件读USART_DR寄存器完成对RXNE位清除,RXNE标志也可以通过对它写0来清除。RXNE位必须在下一字符接收结束前(接收移位寄存器接收满)被清零(要将数据读出)，以避免溢出错误(移位寄存器的数据会被覆盖)。</p>
<p><strong>溢出错误：</strong><br>如果RXNE还没有被复位（还没有读出DR寄存器的数据），又接收到一个字符，则发生溢出错误,数据只有当RXNE位被清零后才能从移位寄存器转移到RDR寄存器。RXNE标记是接收到每个字节后被置位的。如果下一个数据已被收到或先前DMA请求还没被服务时，RXNE标志仍是1，溢出错误产生。  </p>
<p><strong>溢出错误：</strong><br>● ORE位被置位。<br>● RDR内容将不会丢失。读USART_DR寄存器仍能得到先前的数据。<br>● 移位寄存器中以前的内容将被覆盖。随后接收到的数据都将丢失。<br>● 如果RXNEIE位被设置或EIE和DMAR位都被设置，中断产生。<br>● 顺序执行对USART_SR和USART_DR寄存器的读操作，可复位ORE位。<br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/862ae16a75795c1caccea3e91cafd25.png"/></p>
<h4 id="2-3-3-3-USART相关中断："><a href="#2-3-3-3-USART相关中断：" class="headerlink" title="2.3.3.3-USART相关中断："></a>2.3.3.3-USART相关中断：</h4><p>●发送期间：发送完成、清除发送、发送数据寄存器空。<br>●接收期间：空闲总线检测、溢出错误、接收数据寄存器非空、校验错误、 LIN断开符号检测、噪音标志(仅在多缓冲器通信)和帧错误(仅在多缓冲器通信)。<br>如果设置了对应的使能控制位，这些事件就可以产生各自的中断。<br><strong>USART中断映像图</strong><br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/577a3b93c0ad2e715862fa41cdc7a69.png" style="zoom: 50%;"/><br><strong>USART中断请求</strong><br><img src="https://blogpicture123.oss-cn-qingdao.aliyuncs.com/picture/ffa2797aa879fc7d5d48aee97528169.png" style="zoom: 75%;"/></p>
<h3 id="2-3-4-发送一个字节函数"><a href="#2-3-4-发送一个字节函数" class="headerlink" title="2.3.4-发送一个字节函数"></a>2.3.4-发送一个字节函数</h3><p>USART_SendData()函数本质是将要发送的数据写入发送数据寄存器中去，判断数据是否全部从发送数据寄存器转到发送移位寄存中去。全部转移返回值为1，则跳出while语句，未全部转移返回值为0，则一直执行while语句。<br>        &#x2F;&#x2F;全部转移返回值为1，则跳出while语句<br>        &#x2F;&#x2F;未全部转移返回值为0，则一直执行while语句</p>
<pre><code>//发送一个字节
void Usart_SendByte(USART_TypeDef * pUSARTx,uint8_t date)
&#123;
    //USART_SendData()函数本质是将要发送的数据写入发送数据寄存器中去
     USART_SendData(pUSARTx,date);
     while( USART_GetFlagStatus(pUSARTx,USART_FLAG_TXE)== RESET);
&#125;
</code></pre>
<h3 id="2-3-5-发送16位数据"><a href="#2-3-5-发送16位数据" class="headerlink" title="2.3.5-发送16位数据"></a>2.3.5-发送16位数据</h3><pre><code>void Usart_SendHalfWord(USART_TypeDef * pUSARTx,uint16_t date)
&#123;
    uint16_t tmp_h;
    uint16_t tmp_l;
    //取出高8位
    tmp_h =date&gt;&gt;0x08;
    //取出低8位
    tmp_l =date &amp; 0xff;
    //发送高8位数据
    Usart_SendByte(pUSARTx,tmp_h);
    //等待数据全部转移到移位寄存器
    while( USART_GetFlagStatus(pUSARTx,USART_FLAG_TXE)== RESET);
    //发送低8位数据
    Usart_SendByte(pUSARTx,tmp_l);
    //等待数据全部转移到移位寄存器
    while( USART_GetFlagStatus(pUSARTx,USART_FLAG_TXE)== RESET);
&#125;
</code></pre>
<h3 id="2-3-6-发送8位数组"><a href="#2-3-6-发送8位数组" class="headerlink" title="2.3.6-发送8位数组"></a>2.3.6-发送8位数组</h3><pre><code>//发送一个8位的数组
void Usart_SendArray(USART_TypeDef * pUSARTx,uint8_t *arr,uint16_t num)
&#123; 
   while(num--)
     &#123;
         Usart_SendByte( pUSARTx ,*arr++);
//确定数据全部转移到移位寄存器中
         while( USART_GetFlagStatus(pUSARTx,USART_FLAG_TXE)== RESET);
     &#125;
//确定数据全部从移位寄存器发送出去
 while (USART_GetFlagStatus(pUSARTx, USART_FLAG_TC)== RESET);
&#125;
</code></pre>
<h3 id="2-3-7-发送字符串"><a href="#2-3-7-发送字符串" class="headerlink" title="2.3.7-发送字符串"></a>2.3.7-发送字符串</h3><pre><code>//发送字符串
void Usart_SendString( USART_TypeDef * pUSARTx, char *str)
&#123;
 while( *str!=&#39;\0&#39; )
 &#123;
     Usart_SendByte( pUSARTx, *str++); 
     while( USART_GetFlagStatus(pUSARTx,USART_FLAG_TXE)== RESET);
 &#125;
 while (USART_GetFlagStatus(pUSARTx, USART_FLAG_TC)== RESET);
&#125;
</code></pre>
<h2 id="2-4-重定向函数"><a href="#2-4-重定向函数" class="headerlink" title="2.4-重定向函数"></a>2.4-重定向函数</h2><p>在C语言标准库中，fputc函数是printf函数内部的一个函数，功能是将字符ch写入到文件指针f所指向文件的当前写指针位置，简单理解就是把字符写入到特定文件中。我们使用USART函数重新修改fputc函数内容，达到类似“写入”的功能。<br>fgetc函数与fputc函数非常相似，实现字符读取功能。在使用scanf函数时需要注意字符输入格式。<br>还有一点需要注意的，使用fput和fgetc函数达到重定向C语言标准库输入输出函数必须在MDK的工程选项把“Use MicroLIB”勾选上，MicoroLIB是缺省C库的备选库，它对标准C库进行了高度优化使代码更少，占用更少资源。<br>用户能定义自己的C语言库函数，连接器在连接时自动使用这些新的功能函数。这个过程叫做重定向C语言库函数。举例来说，用户有一个I&#x2F;O设备(如UART)。本来库函数fputc()是把字符输出到调试器控制窗口中去的，但用户把输出设备改成了UART端口，这样一来，所有基于fputc()函数的printf()系列函数输出都被重定向到UART端口上去了。<br>该函数写在bsp_usart.c文件中，且不需要在bsp_usart.h文件中声明。</p>
<pre><code>///重定向c库函数printf到串口，重定向后可使用printf函数
int fputc(int ch, FILE *f)
&#123;
        /* 发送一个字节数据到串口 */
        USART_SendData(DEBUG_USARTx, (uint8_t) ch);
        
        /* 等待发送完毕 */
        while (USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_TXE) == RESET);		
    
        return (ch);
&#125;

///重定向c库函数scanf到串口，重写向后可使用scanf、getchar等函数
int fgetc(FILE *f)
&#123;
        /* 等待串口输入数据 */
        while (USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_RXNE) == RESET);

        return (int)USART_ReceiveData(DEBUG_USARTx);
&#125;
</code></pre>
<h2 id="2-5-中断服务函数"><a href="#2-5-中断服务函数" class="headerlink" title="2.5-中断服务函数"></a>2.5-中断服务函数</h2><p>因为所有的USART中断都使用同一个中断服务函数，所以在中断服务函数内要有判断中断类型的语句。该函数写在bsp_usart.c文件中，且不需要在bsp_usart.h文件中声明。</p>
<pre><code>void DEBUG_USART_IRQHandler(void)
&#123;
     uint16_t tmp;
//判断产生的USART中断是属于接收信息中断
if(USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_RXNE) != RESET)
    &#123;
//接收输入的信息
      tmp=USART_ReceiveData(DEBUG_USARTx);
//把接收的信息立即发送出去
      USART_SendData(DEBUG_USARTx,tmp);
//等待数据发送完成
while( USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_TXE)== RESET);
    &#125;
&#125;
</code></pre>
<p>利用中断服务函数控制LED灯的亮灭，注意发送时默认以字符形式发送，比如你发送的是1，但实际上它收到的是1再ASCII码中的序号49。故应勾选以16进制发送。</p>
<pre><code>void DEBUG_USART_IRQHandler(void)
&#123;
    uint16_t tmp;
 //判断中断类型
    if(USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_RXNE) != RESET)
    &#123;
        tmp=USART_ReceiveData(DEBUG_USARTx);
//将单片机收到的数值发送给计算机
        USART_SendData(DEBUG_USARTx,tmp);
        while( USART_GetFlagStatus(DEBUG_USARTx, USART_FLAG_TXE)== RESET);
//判断收到的命令，并控制相应的LED灯亮灭
        switch (tmp)
        &#123;
            case 1: 
                LED_R_ON_OFF(ON);
                printf(&quot;%d\n&quot;,tmp);
                break;
            case 2: 
                LED_G_ON_OFF(ON);
                printf(&quot;%d\n&quot;,tmp);
                break;
            case 3: 
                LED_B_ON_OFF(ON);
                printf(&quot;%d\n&quot;,tmp);
                break;
            default:
                printf(&quot;输入错误，请重新输入\n&quot;);
        &#125;
    &#125;
&#125;
</code></pre>

    </div>

    
    
    

     
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.png">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/03/05/STM32%E5%AE%9A%E6%97%B6%E5%99%A8/" rel="prev" title="STM32定时器">
      <i class="fa fa-chevron-left"></i> STM32定时器
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/03/20/DMA/" rel="next" title="DMA">
      DMA <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81NzY5NS8zNDE1OA=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-0-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">1.0-数据通信方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E4%B8%B2%E8%A1%8C%E4%B8%8E%E5%B9%B6%E8%A1%8C%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="nav-number">1.1.</span> <span class="nav-text">1.1-串行与并行通信方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E5%85%A8%E5%8F%8C%E5%B7%A5%E3%80%81%E5%8D%8A%E5%8F%8C%E5%B7%A5%E5%8F%8A%E5%8D%95%E5%B7%A5%E9%80%9A%E8%AE%AF"><span class="nav-number">1.2.</span> <span class="nav-text">1.2-全双工、半双工及单工通讯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%90%8C%E6%AD%A5%E9%80%9A%E4%BF%A1%E4%B8%8E%E5%BC%82%E6%AD%A5%E9%80%9A%E4%BF%A1"><span class="nav-number">1.3.</span> <span class="nav-text">1.3-同步通信与异步通信</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-%E5%B8%B8%E8%A7%81%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E6%8E%A5%E5%8F%A3%EF%BC%9A"><span class="nav-number">1.4.</span> <span class="nav-text">1.4-常见串口通信接口：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-0-%E4%B8%B2%E5%8F%A3%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE"><span class="nav-number">2.</span> <span class="nav-text">2.0-串口通讯协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E7%89%A9%E7%90%86%E5%B1%82"><span class="nav-number">2.1.</span> <span class="nav-text">2.1-物理层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-RS232%E6%A0%87%E5%87%86"><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1-RS232标准</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-USB%E8%BD%AC%E4%B8%B2%E5%8F%A3%E6%A0%87%E5%87%86"><span class="nav-number">2.1.2.</span> <span class="nav-text">2.1.2-USB转串口标准</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-%E5%8E%9F%E7%94%9F%E7%9A%84%E4%B8%B2%E5%8F%A3%E5%88%B0%E4%B8%B2%E5%8F%A3%E6%A0%87%E5%87%86"><span class="nav-number">2.1.3.</span> <span class="nav-text">2.1.3-原生的串口到串口标准</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E5%8D%8F%E8%AE%AE%E5%B1%82"><span class="nav-number">2.2.</span> <span class="nav-text">2.2-协议层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-USART-%E5%8A%9F%E8%83%BD%E6%A1%86%E5%9B%BE"><span class="nav-number">2.3.</span> <span class="nav-text">2.3-USART 功能框图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-%E5%8A%9F%E8%83%BD%E5%BC%95%E8%84%9A"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1-功能引脚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-%E8%AF%BB%E5%86%99%E5%8D%95%E5%85%83"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2-读写单元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-3-%E6%8E%A7%E5%88%B6%E5%8D%95%E5%85%83"><span class="nav-number">2.3.3.</span> <span class="nav-text">2.3.3-控制单元</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-1-%E5%8F%91%E9%80%81%E5%99%A8"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">2.3.3.1-发送器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-2-%E6%8E%A5%E6%94%B6%E5%99%A8"><span class="nav-number">2.3.3.2.</span> <span class="nav-text">2.3.3.2-接收器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-3-USART%E7%9B%B8%E5%85%B3%E4%B8%AD%E6%96%AD%EF%BC%9A"><span class="nav-number">2.3.3.3.</span> <span class="nav-text">2.3.3.3-USART相关中断：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-4-%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.4.</span> <span class="nav-text">2.3.4-发送一个字节函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-5-%E5%8F%91%E9%80%8116%E4%BD%8D%E6%95%B0%E6%8D%AE"><span class="nav-number">2.3.5.</span> <span class="nav-text">2.3.5-发送16位数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-6-%E5%8F%91%E9%80%818%E4%BD%8D%E6%95%B0%E7%BB%84"><span class="nav-number">2.3.6.</span> <span class="nav-text">2.3.6-发送8位数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-7-%E5%8F%91%E9%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">2.3.7.</span> <span class="nav-text">2.3.7-发送字符串</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E9%87%8D%E5%AE%9A%E5%90%91%E5%87%BD%E6%95%B0"><span class="nav-number">2.4.</span> <span class="nav-text">2.4-重定向函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E4%B8%AD%E6%96%AD%E6%9C%8D%E5%8A%A1%E5%87%BD%E6%95%B0"><span class="nav-number">2.5.</span> <span class="nav-text">2.5-中断服务函数</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="胜哥"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">胜哥</p>
  <div class="site-description" itemprop="description">仰望星空，脚踏实地</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yourname" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://zh.cppreference.com/w/cpp" title="C++参考手册 → https:&#x2F;&#x2F;zh.cppreference.com&#x2F;w&#x2F;cpp" rel="noopener" target="_blank"><i class="fa fa-C++参考手册 fa-fw"></i>C++参考手册</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.bilibili.com/" title="B站 → https:&#x2F;&#x2F;www.bilibili.com&#x2F;" rel="noopener" target="_blank"><i class="fa fa-B站 fa-fw"></i>B站</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://baidu.com/" title="https:&#x2F;&#x2F;baidu.com" rel="noopener" target="_blank">百度</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">胜哥</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">36k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">33 分钟</span>
</div>
        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
